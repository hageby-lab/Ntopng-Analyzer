# 🚨 Ntopng Analyzer с AI-аналитикой для Telegram уведомлений

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)
![Telegram](https://img.shields.io/badge/Telegram-Bot-blue.svg)
![Ntopng](https://img.shields.io/badge/Ntopng-Integration-orange.svg)

**Продвинутая система мониторинга сети, преобразующая алерты ntopng в интеллектуальные уведомления Telegram с AI-аналитикой**

[Возможности](#-возможности) • [Установка](#-установка) • [Настройка](#-настройка) • [Использование](#-использование) • [API](#-api-эндпоинты)

</div>

## 📋 Обзор

Это приложение служит мостом между мониторингом сети **ntopng** и **Telegram**, предоставляя интеллектуальный анализ сетевых алертов с продвинутым обнаружением угроз и поведенческой аналитикой.

### 🎯 Какую проблему решает

- **Сырые алерты ntopng** → **Интеллектуальные инсайты**
- **Ручной мониторинг** → **Автоматизированный AI-анализ** 
- **Сложные сетевые данные** → **Практические рекомендации**
- **Задержки в реагировании** → **Уведомления в реальном времени**

## 🚀 Возможности

### 🔍 Интеллектуальный анализ алертов
- **Обнаружение поведенческих паттернов** - Выявляет аномалии в трафике
- **Анализ угроз** - Обнаружение портов malware, Tor трафика, сканирования портов
- **Геолокационный анализ** - Оценка риска по стране происхождения
- **Анализ направления трафика** - Классификация входящего/исходящего/внутреннего трафика

### 📊 Продвинутая аналитика
- **Композитная оценка риска** (0-100) - Единая оценка угроз
- **Прогнозирование инцидентов** - Предсказывает возможные сценарии атак
- **Исторический анализ** - Учится на предыдущих алертах
- **Рекомендации в реальном времени** - Практические шаги для реагирования

### 💡 Умные функции
- **Идентификация устройств** - Автоматически распознает внутренние устройства
- **Распознавание сервисов** - Определяет внешние сервисы (Google, Cloudflare и др.)
- **Обработка множественных алертов** - Эффективно обрабатывает пакеты алертов
- **Адаптивная оценка риска** - Контекстно-зависимая оценка угроз


## 🎯 Примеры алертов

🔴 Высокорисковый DDoS алерт

🔴 NTOPNG АЛЕРТ - КОМПЛЕКСНЫЙ АНАЛИЗ
├─ ID: 4112 | 📈 Риск: 85/100
├─ Тип: 🌐 Network Alert  
├─ Серьезность: 🔴 Critical
├─ Описание: Massive DDoS traffic detected

🕒 Время: 14.10.2025 13:13:26
📡 Источник: 185.220.101.34 - Tor Exit Node (🌐 Внешний интернет)
🎯 Назначение: 192.168.1.80 - Web-Server (🛡️ Внутренняя сеть)
📊 Направление: 📥 Входящее

🔍 РАСШИРЕННАЯ АНАЛИТИКА
├─ Общий риск: 🔴 85/100
├─ Паттерн трафика: ⚠️ Ночная активность
├─ Уровень угроз: Высокий
├─ Гео-риск: Высокий риск

🕵️‍♂️ ПОВЕДЕНЧЕСКИЙ АНАЛИЗ
├─ Высокий трафик в нерабочее время
├─ Передано 1500MB данных

🛡️ ИНДИКАТОРЫ УГРОЗ
├─ Трафик через Tor сеть
├─ Признаки сканирования портов

📈 ПРОГНОЗ ИНЦИДЕНТА
├─ Сценарий: DDoS атака
├─ Уверенность: Высокая
├─ Время: Минуты-часы
└─ Эскалация: 80%

🚨 РЕКОМЕНДАЦИИ
├─ 🛡️ Временное ограничение трафика с источника
├─ 📞 Уведомить команду безопасности
├─ 🔍 Проверить сетевые устройства на перегрузку
└─ 📊 Проанализировать трафик на DDoS паттерны

🟡 Среднерисковый алерт

🟡 NTOPNG АЛЕРТ - КОМПЛЕКСНЫЙ АНАЛИЗ
├─ ID: 4113
├─ Тип: 🖥️ Host Alert  
├─ Серьезность: 🟡 Warning
├─ Описание: High bandwidth usage

🕒 Время: 14.10.2025 13:15:42
📡 Источник: 192.168.1.50 - File-Server (🛡️ Внутренняя сеть)
🎯 Назначение: 1.1.1.1 - Cloudflare DNS (🌐 Внешний интернет)
📊 Направление: 📤 Исходящее
📋 Протокол: UDP
🔗 Порт: 53
📊 Байты: 250MB

🔵 Низкорисковый алерт

🔵 NTOPNG АЛЕРТ - КОМПЛЕКСНЫЙ АНАЛИЗ
├─ ID: 4114
├─ Тип: 📊 Flow Alert  
├─ Серьезность: ℹ️ Info
├─ Описание: Normal internal traffic

🕒 Время: 14.10.2025 13:20:15
📡 Источник: 192.168.1.10 - Workstation-01 (🛡️ Внутренняя сеть)
🎯 Назначение: 192.168.1.20 - File-Server (🛡️ Внутренняя сеть)
📊 Направление: 🔄 Внутреннее
📋 Протокол: TCP
🔗 Порт: 445

# 🤝 Участие в разработке
Мы приветствуем вклад в разработку! Пожалуйста, ознакомьтесь с нашим Руководством по внесению вклада для деталей.

# 📄 Лицензия
Этот проект лицензирован под MIT License - смотрите файл LICENSE для деталей.

# 🙏 Благодарности

Команда ntopng за отличный мониторинг сети
Telegram за надежную платформу мессенджера
FastAPI за высокопроизводительный веб-фреймворк